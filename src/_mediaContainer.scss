#mediaContainer {
	--controller-offset: 40px;

	&:has(+ #controllerBar.videos) {
		--controller-offset: 72px;
	}

	#mainContainer.floating-tools > & {
		--controller-offset: 0px;
	}

	cursor: pointer;

	flex: 1 0 auto;
	position: relative;
	display: block;
	border-radius: 8px;
	overflow: hidden;
	z-index: 1;

	height: calc(100% - var(--controller-offset));

	background-color: var(--black);

	box-shadow: 0 1px 6px 0px rgba($color: var(--black-rgb), $alpha: 0.8);

	transition:
		height var(--default-timing) ease-in-out,
		transform var(--default-timing) ease-in-out,
		box-shadow var(--default-timing) ease-in-out,
		border-radius var(--default-timing) ease-in-out;

	--static-dark: var(--gray5);
	--static-light: var(--gray7);

	#infoOverlayElem {
		position: absolute;
		display: flex;
		flex-direction: column;
		width: 100%;
		height: 100%;
		align-items: center;
		justify-content: center;

		pointer-events: none;

		font-size: 1.5rem;
		text-shadow:
			1px 0px 2px var(--black),
			0px 1px 2px var(--black),
			-1px 0px 2px var(--black),
			0px -1px 2px var(--black);
		white-space: pre;
		text-align: center;

		z-index: 4;
		opacity: 1;

		transition: opacity 0.15s ease-in-out;

		&:not(:has(*)) {
			opacity: 0;
			transition: opacity var(--default-timing) ease-in-out;
		}
	}

	&.empty {
		cursor: pointer;
	}

	&:has(#videoClipper.divider:not(.stuck):not(.auto)) {
		cursor: ew-resize;
	}

	&:has(#videoClipper.horizontalDivider:not(.stuck):not(.auto)) {
		cursor: ns-resize;
	}

	&:has(#videoClipper.auto) {
        cursor: default;
    }

	&.zoom-out-anim {
		transform: scale(1.005);
		border-radius: 13px;
		box-shadow: 0 0 4px 4px rgba($color: var(--pink-rgb), $alpha: 1);
	}

	&.zoom-in-anim {
		transform: scale(0.994, 0.989);
		border-radius: 0;
		box-shadow: 0 0 4px 3px rgba($color: var(--pink-rgb), $alpha: 1);
	}

	label.file-input {
		--input-size: 120px;
		--input-offset: 75%;
		position: absolute;
		top: calc(50% - var(--input-size) / 2);
		left: calc(var(--input-offset) - var(--input-size) / 2);

		&:nth-child(2) {
			--input-offset: 25%;
		}

		display: flex;
		flex-wrap: wrap;
		gap: calc(4 * var(--spacing)) 0;
		padding: var(--root-padding);

		text-align: center;
		justify-content: center;
		align-items: center;
		align-content: center;
		justify-items: center;

		z-index: 4;

		width: var(--input-size);
		height: var(--input-size);

		background: rgba($color: var(--darker-blue-rgb), $alpha: 0.75);
		box-shadow:
			inset 0px 3px 8px rgba(255, 255, 255, 0.1),
			inset 0px -3px 8px rgba(0, 0, 0, 0.25);
		backdrop-filter: blur(4px);
		/* Note: backdrop-filter has minimal browser support */
		border-radius: 16px;

		appearance: none;

		transition:
			background 0.15s ease-in-out,
			box-shadow 0.15s ease-in-out,
			transform 0.15s ease-in-out;

		> span {
			grid-column: 1 / -1;
			display: block;
			font-weight: 500;
			font-size: 1rem;
		}

		> input {
			display: none;
		}

		&:hover {
			background: rgba($color: var(--darker-blue-rgb), $alpha: 1);
		}
	}

	// generate tv static

	&.empty {
		background: var(--black);
	}

	#videoClipper {
		position: relative;
		// background-color: var(--black);
		box-shadow: 2px 0 0 calc(var(--user-divider-thickness) - 1.5px) var(--user-divider-color);

		z-index: 0;

		&.overlay {
			box-shadow: none;
			background-color: transparent;
		}

		#clipperLock {
			position: absolute;
			inset: 50% var(--spacing) auto auto;
			width: max-content;
			height: max-content;

			--shadow-size: 0.5px;

			filter: drop-shadow(0 0 var(--shadow-size) var(--black)) drop-shadow(0 0 var(--shadow-size) var(--black)) drop-shadow(0 0 var(--shadow-size) var(--black));

			transform: translateY(-50%);

			z-index: 4;
		}

        &.auto {
            #clipperLock {
                display: none;
            }
        }

		&.empty {
			background: var(--black);
		}

		&.divider {
			box-shadow: none;
			will-change: width;

			#clipperLock {
				// Attach to divider line (x), sit left of it by default.
				// Flip to the right when close to the left edge (via --lock-dir-x set in JS).
				inset: auto;
				top: 50%;
				left: clamp(var(--spacing), var(--divider-pos, 0px), calc(100% - var(--spacing)));
				transform: translateX(calc((100% + var(--spacing)) * var(--lock-dir-x, -1))) translateY(-50%);
			}

			&::after {
				content: '';
				position: absolute;
				top: 0;
				bottom: 0;
				left: calc(var(--divider-pos, 0px) - (var(--user-divider-thickness) / 2));
				width: var(--user-divider-thickness);
				background: var(--user-divider-color);
				pointer-events: none;
				z-index: 3;
			}
		}

		&.horizontalDivider {
			box-shadow: none;

			will-change: height;

			&::after {
				content: '';
				position: absolute;
				left: 0;
				right: 0;
				top: calc(var(--divider-pos, 0px) - (var(--user-divider-thickness) / 2));
				height: var(--user-divider-thickness);
				background: var(--user-divider-color);
				pointer-events: none;
				z-index: 3;
			}

			#clipperLock {
				// Attach to divider line (y), sit above it by default.
				// Flip below when close to the top edge (via --lock-dir-y set in JS).
				inset: auto;
				left: 50%;
				top: clamp(var(--spacing), var(--divider-pos, 0px), calc(100% - var(--spacing)));
				transform: translateX(-50%) translateY(calc((100% + var(--spacing)) * var(--lock-dir-y, -1)));
			}
		}

		&.divider,
		&.horizontalDivider {
			width: 100%;
			height: 100%;
			top: 0;
			bottom: 0;
			overflow: hidden;
		}

		&.boxCutout,
		&.circleCutout {
			// clip-path: circle(50% at 50% 50%);
			overflow: hidden;
			// transform: translate(-50%, -50%);

			box-shadow: 0 0 0 calc(var(--user-divider-thickness) + 0.75px) var(--user-divider-color);

			will-change: width, height, left, top;

			transition:
				border-radius var(--default-timing) ease-in-out,
				box-shadow var(--default-timing) ease-in-out;
		}

		&.circleCutout {
			border-radius: 50%;
		}

		&.overlay {
			#clipperLock {
				display: none;
			}
		}

		.clipper-mask {
			position: absolute;
			inset: 0;
		}
	}

	// Wrapper receives positioning - acts like the video element did before
	.videojs-wrapper,
	.image-player-wrapper {
		position: absolute;
		// left: 50%;
		// top: 50%;
		// transform: translate(-50%, -50%);
		display: block;
		pointer-events: none;

		will-change: transform;

		> div {
			display: contents;
		}
	}

	// Video.js elements fill wrapper and centered
	.video-js {
		display: contents;
	}

	// Native video elements (fallback)
	// Images inside wrappers shouldn't have hardcoded positioning - let the wrapper handle it
	video {
		position: absolute !important;
		left: 0 !important;
		top: 0 !important;
		width: 100% !important;
		height: 100% !important;
		display: block;
		object-fit: contain;
		background: var(--black);
		border: none;
		outline: none;
		box-shadow: 0 1px 5px 0px rgba($color: var(--gray5-rgb), $alpha: 0.8);
	}

	// Images need to fill their wrapper and allow dynamic transforms
	img {
		display: block;
		width: 100%;
		height: 100%;
		object-fit: contain;
		background: var(--black);
		border: none;
		outline: none;
		box-shadow: 0 1px 5px 0px rgba($color: var(--gray5-rgb), $alpha: 0.8);
	}

	#videoClipper .videojs-wrapper,
	#videoClipper .image-player-wrapper {
		width: 200%;
		z-index: 1;
	}

	#videoClipper .video-js {
		z-index: 1;
	}

	#videoClipper video,
	#videoClipper img {
		width: 200%;
		z-index: 1;
	}

	// Hide all Video.js UI elements we don't need
	.video-js {
		.vjs-control-bar,
		.vjs-big-play-button,
		.vjs-loading-spinner,
		.vjs-poster,
		.vjs-text-track-display,
		.vjs-error-display,
		.vjs-modal-dialog {
			display: none !important;
		}
	}
}

#validationMessage {
	position: absolute;
	inset: 72px auto auto 50%;

	display: flex;
	flex-direction: column;
	gap: calc(4 * var(--spacing));
	padding: var(--root-padding);

	color: var(--message-color);
	font-size: 1rem;
	font-weight: 500;
	background-color: var(--dark-blue);
	border-radius: calc(var(--radius) + var(--spacing));
	transform: translateX(-50%);

	box-shadow:
		0 3px 8px rgba($color: var(--white-rgb), $alpha: 0.1) inset,
		0 -3px 8px rgba($color: var(--black-rgb), $alpha: 0.25) inset;

	backdrop-filter: blur(var(--controller-spacing));

	height: auto;
	max-width: calc(50% - 2rem);

	#mainContainer.floating-tools & {
		background-color: rgba($color: var(--darker-blue-rgb), $alpha: 0.75);
		opacity: 0;
	}

	#mainContainer:hover &,
	#mainContainer:focus-within & {
		opacity: 1;
		transition:
			opacity var(--default-timing) linear 0s,
			inset var(--default-timing) ease-in-out 0s,
			padding var(--default-timing) ease-in-out 0s,
			var(--default-timing) ease-in-out 0s,
			border-radius var(--default-timing) ease-in-out 0s;
	}

	.validation-warning {
		--message-color: var(--white);

		display: flex;
		gap: calc(4 * var(--spacing));
		align-items: center;

		&.error {
			--message-color: var(--pink);
		}

		&.warning {
			--message-color: var(--caution);
		}

		&.info {
			--message-color: var(--info);
		}

		svg {
			flex-shrink: 0;
		}

		span {
			flex: 1;
		}
	}
}

@keyframes static-anim {
	100% {
		background-position:
			50% 0,
			60% 50%;
	}
}

@keyframes position-delay-rel-to-abs {
	from {
		position: relative;
	}
	to {
		position: absolute;
	}
}
@keyframes position-delay-abs-to-rel {
	from {
		position: absolute;
	}
	to {
		position: relative;
	}
}
